{% extends 'base.html' %}


{% block title %} {{ post.title }} {% endblock title %}
{% block content %}


<section class="" ;>

    <article class="">

        <h1 class="">{{ post.title.upper }}</h1>
        <h5 class="">

        </h5>
        <small>
            By: {{ post.author.first_name.title }} {{ post.author.last_name.title }} |
            Email: {{ post.author.email }}

            <br>
            Created: {{ post.date_created }}
            {% if post.date_updated %}
            <br>
            Last updated: {{ post.date_updated }}
            {% endif %}
        </small>

        {% if user.id == post.author.id %}
        <div class="">
            <a href="{% url 'edit_post' post.slug %}">
                <button type="button" class="">
                    Edit
                </button>
            </a>

            <a class=""
                href="{% url 'delete_post' post.slug %}" id="delete-post">
                Delete
            </a>
        </div>
        {% endif %}
        <hr>

        <div class="" id="delete-post-modal">
            <div class="">
                <div class="" style=" margin-right: 2em; max-width: 100%;">
                    <form method="POST" class="" id="delete-post-form">
                        {% csrf_token %}

                        <p>
                            <strong class="">Are you sure you want to delete '{{ post.title }}'?</strong>
                        </p>

                        <div class="">
                            <button type="submit" class="">
                                <!-- <a class="ms-3" href="{% url 'delete_post' post.slug %}"> -->
                                Confirm
                                <!-- </a> -->
                            </button>


                            <button type="button" class="">
                                Cancel
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <div class="" style="margin-top: 20px;">
            <!-- {{ post.formatted_markdown|safe }} -->
            {{ post.body | safe}}
        </div>
        </div>
    </article>

    <div class="" style="width: 90%" ;">
        <h3>Comments:</h3>
        <h6 class="">{{ comments.count }} comment{{ comments.all|pluralize }}</h6>

        {% if comments.all %}
        {% for comment in comments.all %}
        <div class="">
            <strong>{{ comment.commentator}}</strong>
            <div class="">{{ comment.formatted_markdown|safe }}</div>
            <p><small>{{ comment.timestamp }}</small></p>
            <hr>
        </div>

        {% endfor %}

        {% else %}
        <p>No comment yet. Be the first to add a comment</p>
        {% endif %}
    </div>

    <form action="" method="POST" class="">
        {% csrf_token %}
        <label for="{{ comment_form.comment_body.id_for_label }}">
            Add comment:
        </label>
        <div class="">
            {{ comment_form.comment_body }}
        </div>


        <button type="submit" class="" {% if user.is_anonymous %} disabled {% endif %}>
            Post
        </button>

        {% if user.is_anonymous %}
        <span>
            <a href="{% url 'account_login' %}">Log in to comment</a>
        </span>
        {% endif %}
    </form>
    <div class="" style="width: 20%;">
        {{ form.media }}
    </div>
</section>

{% if all_author_post %}
<div>
    <h4>
        More Posts By
        {{ post.author.first_name }} {{ post.author.last_name }}
    </h4>
    {% for post in all_author_post %}
    <div class="">
        <a class="" href="{% url 'article_detail' post.slug%}">
            {{post.title}}
        </a>
    </div {% endfor %} </div>
    {% endif %}


    <br>
    <button class="" onclick="history.back()">
        Go back
    </button>
</div>




{% endblock content %}